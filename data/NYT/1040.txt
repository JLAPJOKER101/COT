
NAIROBI, Kenya &mdash; Fierce fighting broke out across Somalia on Thursday along several different fronts, as African Union peacekeepers, Somali government soldiers, allied militias and Ethiopian troops opened a multipronged offensive against radical Islamist insurgents.        

The peacekeepers fought house to house in Somalia&rsquo;s capital, Mogadishu, pushing back insurgents but taking heavy losses, according to African Union officials.        

On the Ethiopian border, residents said that Ethiopian tanks had rolled into battle and shelled positions belonging to the Shabab, the country&rsquo;s main militant Islamist group.        

And in southern Somalia, a militia allied with the transitional Somali government attacked insurgents while Kenyan troops tried to seal the border between the countries, a Western security adviser said.        

According to the adviser, who was not authorized to speak publicly, the fighting adhered to a longstanding plan: to spread the insurgents thin and attack them in several places at once.        

&ldquo;There has been chatter for the last month about a coordinated offensive,&rdquo; the adviser said.        

The Shabab, who have pledged allegiance to Al Qaeda, are powerful and widely feared in Somalia, but they have only a few thousand hard-core fighters. The adviser said it was too early to tell if the current fighting was indeed a turning point in the battle against them, but he noted that the offensive seemed to be a coordinated effort.        

For nearly the past two years, Somalia&rsquo;s transitional government has been pinned down in a bullet-ridden corner of Mogadishu. All that stands between it and collapse are 8,000 African Union peacekeepers.        

About a year ago, Western countries, including the United States, began preparing the Somali government and the African Union to go on the offensive and attack the Shabab, who have terrorized the population by cutting off hands and publicly executing people. The Shabab have also banned bras and music in some of the areas they control and even pulled out gold teeth, saying such things violated Islamic law.        

The American government has been supplying arms and paying salaries for Somali troops, in addition to substantially financing  the African Union peacekeeping mission. In the past few days, the peacekeepers have spearheaded the fighting, deploying tanks, armored bulldozers and artillery to pound insurgent positions in Mogadishu. Over the weekend, the peacekeepers wrested several blocks from the Shabab and discovered an extensive underground tunnel and trench system that the insurgents had been using to sneak up on the peacekeepers.        

The Shabab deny that they are losing, and Shabab fighters recently struck back with a deadly suicide bombing and have displayed the bodies of slain Burundian peacekeepers killed in battle &mdash; at least eight peacekeepers have been killed in recent days.        

But African Union and Somali officials said they had taken over several Shabab bases in Mogadishu and were pushing the insurgents back.        

&ldquo;We will not stop the fight until we completely free the enemy from our country,&rdquo; said Mohamed Abdullahi Mohamed, Somalia&rsquo;s prime minister.        

In Belet Weyne, near the Ethiopian border, residents described fierce clashes involving Ethiopian tanks and armored vehicles. Ethiopia sent tens of thousands of troops into Somalia in 2006 in an attempt to quash an Islamist movement that controlled much of Somalia at the time. The Ethiopians pulled out in early 2009 &mdash; officially, at least, though residents along the border often report small incursions.        

On Thursday, residents said the Ethiopians had cornered a large contingent of Shabab forces at Belet Weyne&rsquo;s airport, which was being shelled. Many civilians were fleeing.        

In Bulo Hawo, a town near the Kenyan border that has changed hands several times recently, a clan-based militia allied with the Somali government attacked the Shabab. The assault did not seem to be working, however, because Shabab fighters were thoroughly dug in, the Western adviser said.        

Bishar Adam, a Shabab official in the town, displayed a number of bodies of freshly killed men on Wednesday and said that they were government soldiers.        

Alfred Mutua, a Kenyan government spokesman, said Thursday that Kenyan troops were not involved in the battles but that Kenya had sent extra troops to the border, to seal it off.        

&ldquo;We&rsquo;ve fortified our side of the border so the fighting doesn&rsquo;t spill over,&rdquo; Mr. Mutua said. &ldquo;It&rsquo;s a bit haphazard. It&rsquo;s not even clear which groups are fighting whom.&rdquo;        
Jeffrey Gettleman reported from Nairobi, and Mohammed Ibrahim from Mogadishu, Somalia.
